name: CI/CD Pipeline\n\non:\n  push:\n    branches: [ main, develop ]\n  pull_request:\n    branches: [ main, develop ]\n  schedule:\n    - cron: '0 2 * * *'\n\njobs:\n  test:\n    runs-on: ubuntu-latest\n    \n    services:\n      postgres:\n        image: postgres:16-alpine\n        env:\n          POSTGRES_DB: factmarrow_test\n          POSTGRES_PASSWORD: testpass\n        options: >\n          --health-cmd pg_isready\n          --health-interval 10s\n          --health-timeout 5s\n          --health-retries 5\n        ports:\n          - 5432:5432\n    \n    steps:\n      - uses: actions/checkout@v4\n      \n      - name: Set up Python\n        uses: actions/setup-python@v4\n        with:\n          python-version: '3.11'\n          cache: 'pip'\n      \n      - name: Install dependencies\n        run: |\n          python -m pip install --upgrade pip\n          pip install -r requirements.txt\n      \n      - name: Lint with flake8\n        run: |\n          flake8 src tests --count --select=E9,F63,F7,F82 --show-source --statistics\n          flake8 src tests --count --exit-zero --max-complexity=10 --max-line-length=127 --statistics\n      \n      - name: Run tests\n        env:\n          DATABASE_URL: postgresql://postgres:testpass@localhost:5432/factmarrow_test\n          ANTHROPIC_API_KEY: ${{ secrets.ANTHROPIC_API_KEY }}\n        run: |\n          pytest tests/ -v || true\n"